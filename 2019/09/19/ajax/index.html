


<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,inital-scale=1,user-scalable=no">
  <title>ajax [ Hexo ]</title>
  <!-- bootstrapcss文件 -->
 <!--  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> -->
<!--   <link rel="stylesheet" href="/css/zhl.css">
 -->
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/fork-awesome.min.css">
    
      <link rel="stylesheet" href="/css/zhl.css">
    
  
  
</head></html>
<body>
<div class="container-fluid">
  <div class="row">
  <div id="wrap" class="col-md-12">
    <div id="header">
	<div id="header-left">
	<h1 id="header-title"> 
	<a href="/">
		Hexo
	</a>
	</h1>
	
	</div>
	<div id="header-right">
		
		
		<a href="/"  title="home"><i class="fa fa-home ">home</i></a>
		
		<a href="https://github.com/lizehongss/demo_show"  title="demo"><i class="fa fa-code ">demo</i></a>
		
		<a href="/about"  title="about"><i class="fa fa-user ">about</i></a>
		
		<a href="/"  title="music"><i class="fa fa-music ">music</i></a>
		
		
	</div>
</div>

  </div>
  </div>
  <div id="content" class="row">
    <div id="content-left" class="col-md-4">
      

	

	

	
	<div class="widget-wrap">
		<h3 class="widget-title fa fa-archive">归档</h3>
		<div class="widget">
			<ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">3</span></li></ul>
		</div>
	</div>



    </div>
    <div id="content-right" class="col-md-8">
    
<article id="post">
	<div class="post-title">
  <h1>ajax</h1>
  	</div>
  <div class="page-meta">
  	<span class="fa-wrap">
  		<i class="fa fa-clock-o"></i>
  		<span class="date-meta">2019-09-19</span>
  	</span>
  	<span class="fa-wrap">
  		
  	</span>
  	<span class="fa-wrap">
  		
  	</span>
  </div>
  <div class="post-content">
  <h2 id="第1章-预备知识"><a href="#第1章-预备知识" class="headerlink" title="第1章 预备知识"></a>第1章 预备知识</h2><h3 id="服务器和客户端"><a href="#服务器和客户端" class="headerlink" title="服务器和客户端"></a>服务器和客户端</h3><ul>
<li><p>服务器 = 高配置硬件 + 特殊软件（能提供服务的软件）</p>
</li>
<li><p>客户端= 低配置硬件 + 一般软件（能享受服务的软件）</p>
</li>
<li><p>web服务器 =  高配置硬件 +能提供web服务的软件（web服务就是让和客户端能访问网页的服务）</p>
<h3 id="web请求与响应"><a href="#web请求与响应" class="headerlink" title="web请求与响应"></a>web请求与响应</h3><p>请求：客户端浏览器向web服务器发起请求；<br>响应：</p>
</li>
<li><p>web服务器收到请求后，进行处理，并返回处理结果；</p>
</li>
<li><p>浏览器会解析这个结果，显示在网页上；</p>
</li>
<li><p><strong>如果这个.html文件中引用外部的资源（.css,.js.png） 会再次发请求</strong>；</p>
</li>
</ul>
<h3 id="虚拟web服务器-访问网页"><a href="#虚拟web服务器-访问网页" class="headerlink" title="虚拟web服务器-访问网页"></a>虚拟web服务器-访问网页</h3><ul>
<li><p>双击启动，不要关，不要动</p>
</li>
<li><p>网页文件复制public下，就相当于操作服务器上的文件了。</p>
</li>
<li><p>在浏览器中输入指定的网址来访问。</p>
</li>
</ul>
<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><ul>
<li><p>小黑窗服务器已经内置了接口；</p>
</li>
<li><p>接口是后端程序员写的函数，我们通过ajax技术来调用这个函数；</p>
</li>
<li><p>后端写接口，前端调接口；</p>
</li>
</ul>
<h3 id="什么是http协议"><a href="#什么是http协议" class="headerlink" title="什么是http协议"></a>什么是http协议</h3><p>http协议是浏览器与web服务器之间的通信约定；<br>两个部分组成：</p>
<ul>
<li>请求报文：对请求的约定</li>
<li>响应报文：对响应的约定</li>
</ul>
<h3 id="请求报文"><a href="#请求报文" class="headerlink" title="请求报文"></a>请求报文</h3><p>三个部分：</p>
<ul>
<li><p>请求行<br>包含请求方式 和<strong>请求地址</strong></p>
</li>
<li><p>请求头</p>
</li>
<li><p>请求体：本次请求带的参数<br>get没有请求体；post有请求体</p>
<h3 id="响应报文"><a href="#响应报文" class="headerlink" title="响应报文"></a>响应报文</h3><p>三个部分：</p>
</li>
<li><p>响应行</p>
<p><strong>状态码。至少要记住5个</strong>。</p>
</li>
<li><p>响应头</p>
</li>
<li><p>响应体</p>
</li>
</ul>
<p><strong>内容在响应体中。这里才是重点</strong></p>
<h2 id="第2章-认识ajax"><a href="#第2章-认识ajax" class="headerlink" title="第2章 认识ajax"></a>第2章 认识ajax</h2><h3 id="AJAX的应用场景"><a href="#AJAX的应用场景" class="headerlink" title="AJAX的应用场景"></a>AJAX的应用场景</h3><p>ajax是一种技术方案，它的应用场景是：在不刷新页面的情况下，去请求服务器，以获取新的数据。简称：<strong>局部更新</strong></p>
<h3 id="AJAX是什么"><a href="#AJAX是什么" class="headerlink" title="AJAX是什么"></a>AJAX是什么</h3><ul>
<li>中文是异步的javascript和XML</li>
<li>AJAX并不是一种新技术，而是一种成熟的解决方案。它要解决的问题是在<strong>网页的局部更新</strong>。<ul>
<li>A:异步的</li>
<li>X:xml</li>
</ul>
</li>
<li>浏览器通过内置对象 XMLHttpRequest 向服务器发起请求，并可以接收服务器返回给浏览器的数据，这一过程或实现这一过程的技术就是我们所说的 Ajax。<h3 id="AJAX的优点"><a href="#AJAX的优点" class="headerlink" title="AJAX的优点"></a>AJAX的优点</h3>局部更新，提升用户体验。<br>分离开发，提高开发效率。</li>
</ul>
<h2 id="第3章-JQuery中的ajax"><a href="#第3章-JQuery中的ajax" class="headerlink" title="第3章 JQuery中的ajax"></a>第3章 JQuery中的ajax</h2><h3 id="ajax基本使用"><a href="#ajax基本使用" class="headerlink" title="$.ajax基本使用"></a>$.ajax基本使用</h3><p>发ajax请求就是填空题。</p>
<p>答案在：<strong>接口文档中</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(</span><br><span class="line">  &#123;</span><br><span class="line">     url,//接口地址。后端接口文档中规定了，不能修改。</span><br><span class="line">     type:  //请求的类型。后端接口文档中规定了，不能修改。</span><br><span class="line">     data: // 传递的数据。后端接口文档中规定了参数，前端按需填入。</span><br><span class="line">     success: function (result) &#123;</span><br><span class="line">				 // 前端定义的回调函数，在请求成功之后，自动被调用</span><br><span class="line">         console.log(result)</span><br><span class="line">       &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="ajax中的回调函数"><a href="#ajax中的回调函数" class="headerlink" title="ajax中的回调函数"></a>ajax中的回调函数</h3><ul>
<li>回调函数是我们自己定义的，供别人调用的函数</li>
<li>ajax请求发出之后，由于我们不知道何时服务器会处理完这个请求，所以我们通过回调函数的方式来处理服务器的返回值</li>
<li>success:function(  响应体 ){}</li>
</ul>
<h3 id="ajax与http协议"><a href="#ajax与http协议" class="headerlink" title="ajax与http协议"></a>ajax与http协议</h3><p>ajax请求是http请求中的一种类型，它也遵循http协议。<br>学习ajax要观察network面板中的请求与响应</p>
<h3 id="ajax与接口"><a href="#ajax与接口" class="headerlink" title="ajax与接口"></a>ajax与接口</h3><ul>
<li>接口是后端同学写好的函数；后端写接口；请端调接口；</li>
<li>ajax请求与普通请求访问接口时的区别：<ul>
<li>ajax可以人为控制何时调用接口，如何处理返回值；</li>
<li>普通请求不能控制</li>
</ul>
</li>
</ul>
<h3 id="中的get请求"><a href="#中的get请求" class="headerlink" title="$中的get请求"></a>$中的get请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    type:&apos;get&apos;,</span><br><span class="line">    url://接口地址</span><br><span class="line">    data://参数</span><br><span class="line">    success:function(res)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="第4章-案例-留言板"><a href="#第4章-案例-留言板" class="headerlink" title="第4章 [案例]留言板"></a>第4章 [案例]留言板</h2><h3 id="留言板-演示及分析"><a href="#留言板-演示及分析" class="headerlink" title="留言板-演示及分析"></a>留言板-演示及分析</h3><p>先分析功能再开始做</p>
<h3 id="留言板-获取留言"><a href="#留言板-获取留言" class="headerlink" title="留言板-获取留言"></a>留言板-获取留言</h3><ul>
<li>获取留言的功能是由接口提供的，我们只是调用接口。</li>
<li>获取回来的数据是数组，要通过循环和字符串拼接来把数组转成html结构<ul>
<li>对时间进行格式转化 var formatdt = new Date(item.created).toLocaleString();</li>
<li>在显示留言之间，要先清空留言区域</li>
</ul>
</li>
</ul>
<h3 id="留言板-添加留言"><a href="#留言板-添加留言" class="headerlink" title="留言板-添加留言"></a>留言板-添加留言</h3><ul>
<li>添加留言的功能是由接口提供的，我们只是调用接口。</li>
<li>对获取的用户填入的数据一定要做校验<ul>
<li>是否填写了？</li>
<li>填写的内容是否够用？</li>
</ul>
</li>
<li>添加留言成功之后<ul>
<li>还要再次更新页面</li>
<li>清空发言区域</li>
</ul>
</li>
</ul>
<h2 id="第5章-模板引擎"><a href="#第5章-模板引擎" class="headerlink" title="第5章 模板引擎"></a>第5章 模板引擎</h2><h3 id="常见模板引擎"><a href="#常见模板引擎" class="headerlink" title="常见模板引擎"></a>常见模板引擎</h3><p>模板引擎</p>
<ul>
<li>作用： 用数据和指定格式的模板生成html字符串。</li>
<li>使用：模板引擎的产品非常多，其使用方法都大致相同，查阅文档即可。</li>
</ul>
<h3 id="arttemplate快速使用"><a href="#arttemplate快速使用" class="headerlink" title="arttemplate快速使用"></a>arttemplate快速使用</h3><p>使用步骤</p>
<ol>
<li>引入template-web.js文件</li>
<li>定义模板，注意指定script的id和type属性</li>
<li>准备数据。数据是对象格式。</li>
<li>调用template函数，为模板分配数据，获得渲染结果。</li>
</ol>
<h3 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h3><ul>
<li>artTemplate模板中支持两种语法；</li>
<li>artTemplate模板中的条件语句的写法；</li>
<li>artTemplate模板中循环语句的写法；</li>
<li>artTemplate模板中使用外部函数；</li>
</ul>
<h2 id="第6章-原生ajax"><a href="#第6章-原生ajax" class="headerlink" title="第6章 原生ajax"></a>第6章 原生ajax</h2><h3 id="原生ajax基本格式"><a href="#原生ajax基本格式" class="headerlink" title="原生ajax基本格式"></a>原生ajax基本格式</h3><ul>
<li><p>ajax的功能是由XMLHttpRequest对象实现的</p>
</li>
<li><p>原生ajax的格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 第一步： 新建一个XMLHttpRequest对象(xhr)</span><br><span class="line">  var xhr = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">// 第二步： 设置请求。 xhr.open(请求的方式，接口的url地址);</span><br><span class="line">xhr.open(&apos;get&apos;, &apos;common/getCurrentTime&apos;);</span><br><span class="line"></span><br><span class="line">// 第三步：设置回调函数。返回的数据存放在xhr.responseText中。</span><br><span class="line">xhr.onload = function() &#123;</span><br><span class="line">    console.info(&apos;从服务器返回的数据&apos;,    xhr.responseText);</span><br><span class="line">&#125;;</span><br><span class="line">// 第四步： 发送请求。</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="原生ajax发get请求-带参数"><a href="#原生ajax发get请求-带参数" class="headerlink" title="原生ajax发get请求-带参数"></a>原生ajax发get请求-带参数</h3><ul>
<li>get请求的参数会以<strong>查询字符串的格式</strong>附加在请求地址后面<ul>
<li>url?参数1=值1&amp;参数2=值2</li>
</ul>
</li>
<li>在network中观察参数出现的位置。<ul>
<li>在http的请求行中可以看到</li>
<li>在请求的地址中也可以看到</li>
</ul>
</li>
</ul>
<h3 id="原生ajax发post请求"><a href="#原生ajax发post请求" class="headerlink" title="原生ajax发post请求"></a>原生ajax发post请求</h3><p>服务器上接口是post类型的，使用原生的ajax发请求时，要注意两点区别：</p>
<ol>
<li><p>如果有参数，则参数以查询字符串的格式附加在send()方法中；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var p = &apos;userName=&apos; + name + &apos;&amp;password=&apos; + pwd;</span><br><span class="line">xhr.send(p);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>参数<ul>
<li>可以在http协议的请求体中看到</li>
<li>可以在network面板中看到 </li>
</ul>
</li>
</ul>
<ol start="2">
<li><p>要设置请求头。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.setRequestHeader(&apos;Content-type&apos;, &apos;application/x-www-form-urlencoded&apos;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h3 id="get和post的区别"><a href="#get和post的区别" class="headerlink" title="get和post的区别"></a>get和post的区别</h3><ul>
<li>是使用get还是post完全由后端接口决定，前端调用时，只能照写；</li>
<li>get传递参数，参数是请求行中<ul>
<li>在地址栏中能看见</li>
</ul>
</li>
<li>post传递参数，参数是在请求体中<ul>
<li>在地址栏中看不见。</li>
<li>额外设置请求头</li>
<li>把参数写在send()方法中</li>
</ul>
</li>
</ul>
<h3 id="其它请求方式"><a href="#其它请求方式" class="headerlink" title="其它请求方式"></a>其它请求方式</h3><ul>
<li>接口的类型不仅只有get,post<ul>
<li>put <ul>
<li>小黑窗服务器内置一个put类型接口：</li>
<li>xhr.open(‘put’, ‘<a href="http://localhost:3005/common/putapitest&#39;" target="_blank" rel="noopener">http://localhost:3005/common/putapitest&#39;</a>);</li>
</ul>
</li>
<li>delete</li>
<li>option</li>
</ul>
</li>
<li><strong>接口是什么类型，是由后端决定的</strong></li>
</ul>
<h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><ul>
<li><p>json是一种特殊格式的字符串：它可以与js中的对象进行转换</p>
<ul>
<li>JSON.parse(JSON字符串)  === &gt; js中的数据</li>
<li>JSON.stringify(js中的数据) ===&gt; JSON字符串</li>
</ul>
</li>
<li><p>从接口中返回的数据都是字符串</p>
<ul>
<li>大多数都是JSON字符串</li>
</ul>
</li>
</ul>
<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><ul>
<li>与json一样，是一个特殊的字符串，表示数据</li>
<li>ajax,x就是xml</li>
<li>现在被json取代<ul>
<li>json更简单</li>
</ul>
</li>
</ul>
<h3 id="理解同步异步"><a href="#理解同步异步" class="headerlink" title="理解同步异步"></a>理解同步异步</h3><p>同步：代码的书写顺序和执行顺序相同；<br>异步：代码中的书写顺序与执行顺序不相同；</p>
<h3 id="ajax中的同步异步"><a href="#ajax中的同步异步" class="headerlink" title="ajax中的同步异步"></a>ajax中的同步异步</h3><p>第三个参数是控制同异步的；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(类型,地址,是否异步)</span><br><span class="line">xhr.open(类型,地址,false); // 同步的方式</span><br></pre></td></tr></table></figure>

<p>推荐使用异步的方式；</p>
<h3 id="onreadystatechange及ajax状态码"><a href="#onreadystatechange及ajax状态码" class="headerlink" title="onreadystatechange及ajax状态码"></a>onreadystatechange及ajax状态码</h3><p> xhr的onload是新添加的事件，ie7,8不能使用它。之前使用onreadystatechange。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">xhr.onreadystatechange =function()&#123;</span><br><span class="line">  if(xhr.readyState === 4)&#123;</span><br><span class="line">  // console.log(xhr.responseText)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;======&gt;</span><br><span class="line">xhr.onload =function()&#123;</span><br><span class="line">  console.log(xhr.responseText)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>xhr.readystate : 表示ajax的状态</p>
</li>
<li><p>xhr.status:表示http响应的状态码</p>
</li>
</ul>
<h3 id="get-ie浏览器缓存问题"><a href="#get-ie浏览器缓存问题" class="headerlink" title="get-ie浏览器缓存问题"></a>get-ie浏览器缓存问题</h3><p>问题：在ie浏览中，如果多次get请求的地址都一样，则第二次之后的请求将不会发送，沿用第一次请求的结果。</p>
<p>解决：在请求参数中添加一个额外的参数（注意这个参数不要与接口自身的参数冲突），其作用就是让每一次的请求的地址与之前的都不一样，这样浏览器就不会缓存这个get请求了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url?_=时间戳；</span><br><span class="line">url?a=1&amp;b=2&amp;_=时间戳；</span><br></pre></td></tr></table></figure>

<h3 id="ajax中的异常错误处理"><a href="#ajax中的异常错误处理" class="headerlink" title="ajax中的异常错误处理"></a>ajax中的异常错误处理</h3><p>配合onreadystatechange和xhr.status来处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">xhr.onreadystatechange = function() &#123;</span><br><span class="line">        if (xhr.readyState == 4) &#123;</span><br><span class="line">          if (xhr.status === 404) &#123;</span><br><span class="line">            alert(&apos;请联系XXX管理员。接口地址找不到&apos;);</span><br><span class="line">            // .接口地址找不到</span><br><span class="line">          &#125; else if (xhr.status === 500) &#123;</span><br><span class="line">            alert(&apos;请联系XXX管理员。服务器错误&apos;);</span><br><span class="line">            // .接口地址找不到</span><br><span class="line">          &#125; else if (xhr.status === 200) &#123;</span><br><span class="line">            console.log(xhr.responseText);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br></pre></td></tr></table></figure>

<p>xhr.readyState:xhr的准备状态，有5个取值（0，1，2，3，4）。</p>
<p>xhr.status:http响应的状态(本次请求的响应行中看到)</p>
<pre><code>- 200
- 404
- 301
- 500</code></pre><h3 id="FormData-快速获取表单元素中的数据"><a href="#FormData-快速获取表单元素中的数据" class="headerlink" title="FormData - 快速获取表单元素中的数据"></a>FormData - 快速获取表单元素中的数据</h3><ul>
<li><p>功能：快速获取表单元素中的数据，方便通过ajax向接口发请求</p>
</li>
<li><p>格式：<code>var fd = new FormData(表单dom元素)</code></p>
</li>
<li><p>使用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 1. 获取参数</span><br><span class="line">var fd = new FormData(document.getElementById(&apos;myform&apos;));</span><br><span class="line"></span><br><span class="line">// 2.发ajax请求</span><br><span class="line">var xhr = new XMLHttpRequest();</span><br><span class="line">  </span><br><span class="line">xhr.open(&apos;post&apos;, &apos;/common/postapitest&apos;);</span><br><span class="line">// 不要设置请求头。</span><br><span class="line">// 原因是：传递formData对象，会自己设置一个特殊的请求头 &apos;content-type&apos;,&apos;multipart/formdata&apos;</span><br><span class="line">// 就不要设置xhr.setRequestHeader(&apos;content-type&apos;, &apos;application/x-www-form-urlencoded&apos;);</span><br><span class="line"></span><br><span class="line">xhr.onload = function() &#123;</span><br><span class="line">    console.log(xhr.responseText);</span><br><span class="line">&#125;;</span><br><span class="line">// xhr.send(&apos;name=&apos; + name);</span><br><span class="line">// 直接传递fd对象</span><br><span class="line">xhr.send(fd);</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="FormData-的api"><a href="#FormData-的api" class="headerlink" title="FormData 的api"></a>FormData 的api</h3><ul>
<li><p>fd.get(‘表单组件的name属性值’)</p>
</li>
<li><p>fd.append(‘属性名’，属性值)</p>
</li>
</ul>
<h3 id="FormData-上传文件"><a href="#FormData-上传文件" class="headerlink" title="FormData-上传文件"></a>FormData-上传文件</h3><ul>
<li>文件控件： input type=”file”</li>
<li>通过formData获取这个文件</li>
<li>上传到接口： xhr.send(fd)</li>
</ul>
<h3 id="FormData-上传文件-进度条"><a href="#FormData-上传文件-进度条" class="headerlink" title="FormData-上传文件-进度条"></a>FormData-上传文件-进度条</h3><ul>
<li><p>原理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//在上传的过程，100ms onprogress就要被调用一次。</span><br><span class="line">xhr.upload.onprogress = function(e)&#123;  </span><br><span class="line">	// e.loaded; // 已经上传的大小</span><br><span class="line">	//  e.total; //总大小</span><br><span class="line">	e.loaded / e.total * 100 ---&gt; 进度条的百分比值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><ul>
<li>步骤，阶段</li>
</ul>

	</div>
</article>



    </div>
  </div>
  <div class="row">
<div id="bottom" class="col-md-12"> 
  <div class="bottom-nav">
	
	
	<a href="https://github.com/lizehongss" class="fa fa-github fa-2x" target="_blank" title="Follow me" ></a>
	
	
</div>
<div class="bottom-info">
	&copy; 2019 John Doe<br>
	Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	theme <a href="https://github.com/lizehongss/hexo-theme-zhl" target="_blank">zhl</a>
</div>
</div>
</div>
</div>
<div id="tool">
  <ul>
    <li class="fa fa-angle-up top" id="top"></li>
  </ul>
</div>
  <div class="bg_content">
    <canvas id="canvas"></canvas>
  </div>
  
  <!-- scripts list from theme config.yml -->
  
    <script src="/js/zhl.js"></script>
  
    <script src="/js/bj.js"></script>
  

<!-- jQ cdn  -->
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<!-- bootstrap js cdn-->
<!-- <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> -->


</body>
</html>
